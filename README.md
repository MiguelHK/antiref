[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.7474336.svg)](https://doi.org/10.5281/zenodo.7474336)
[![Made withJupyter](https://img.shields.io/badge/Made%20with-Jupyter-orange?logo=Jupyter)](https://jupyter.org/try)
![GitHub](https://img.shields.io/github/license/briney/antiref)


# AntiRef: reference clusters of human antibody sequences

AntiRef (**Anti**body **Ref**erence Clusters), which was inspired by [UniRef](https://academic.oup.com/bioinformatics/article/23/10/1282/197795), provides clustered datasets of filtered human antibody sequences. The Jupyter notebooks in this repository contain all code necessary to recreate AntiRef entirely from scratch:

* **download**: downloads raw datasets from the Observed Antibody Space (OAS) repository. Note that the combined total of these datasets is quite large -- nearly 4TB after decompression.
* **filter**: filters the raw sequences to ensure only productive, full-length sequences are used to compile AntiRef.
* **cluster**: performs a nested clustering procedure using a series of identity thresholds of decreasing stringency. This process is similar to that used by UniRef, although the thresholds were optimized for antibody sequence data rather than general protein seqeunces. 

### What is *nested clustering*?


![iterative clustering schematic](https://github.com/briney/antiref/blob/master/img/antiref_iterative-clustering.jpg?raw=true)

### Why AntiRef?
Biases in the human antibody repertoire result in publicly available antibody sequence datasets containing many duplicate or highly similar sequences. These redundant sequences are a barrier to rapid similarity searches and reduce the efficiency with which these datasets can be used to train statistical or machine learning models of human antibodies. Identity-based clustering provides a solution, however, the extremely large size of available antibody repertoire datasets make such clustering operations computationally intensive and potentially out of reach for many scientists and researchers who would benefit from such data.

Starting from a dataset of ~335M unique, full-length, productive human antibody sequences from the Observed Antibody Space repository, several AntiRef cluster sets were generated. Due to the modular nature of recombined antibody genes, the clustering thresholds used by UniRef (100, 90 and 50 percent identity) to cluster general protein sequences are suboptimal for antibody clustering. AntiRef provides reference antibody sequence datasets clustered at a range of relevant identity thresholds: 100, 99, 98, 96, 94, 92 and 90 percent. AntiRef90, which uses the lowest clustering threshold of any AntiRef dataset, is roughly one-third the size of the filtered input dataset and less than half the size of the non-redundant AntiRef100.

### Where can I download AntiRef datasets?
AntiRef comprises a series of datasets, each representing one of several clustering thresholds. AntiRef datasets were generated by a nested clustering procedure similar to UniRef which, proceeding in order of decreasing stringency, clusters the representative sequences from the preceding round of clustering. AntiRef datasets can be found at the following links:

* [AntiRef100](https://doi.org/10.5281/zenodo.7474657): representative sequences resulting from clustering all filtered AntiRef input sequences at 100% identity.
* [AntiRef99](https://doi.org/10.5281/zenodo.7475961): representative sequences resulting from clustering AntiRef100 at 99% identity.
* [AntiRef98](https://doi.org/10.5281/zenodo.7476040): representative sequences resulting from clustering AntiRef99 at 98% identity.
* [AntiRef96](https://doi.org/10.5281/zenodo.7487182): representative sequences resulting from clustering AntiRef98 at 96% identity.
* [AntiRef94](https://doi.org/10.5281/zenodo.7487199): representative sequences resulting from clustering AntiRef96 at 94% identity.
* [AntiRef92](https://doi.org/10.5281/zenodo.7487264): representative sequences resulting from clustering AntiRef94 at 92% identity.
* [AntiRef90](https://doi.org/10.5281/zenodo.7487298): representative sequences resulting from clustering AntiRef92 at 90% identity.

### Files
The following files are included in the primary AntiRef data repository:

* **antiref_cluster-manifest.csv.gz:** A compressed CSV file containing the cluster assignments for every sequence in the AntiRef input dataset. For each AntiRef round, cluster names correspond to the sequence ID of the representative sequence (as determined by MMSeqs2). The nested clustering process conserves cluster names between iterations, meaning the clustering lineage of any sequence can easily be traced across all AntiRef datasets.
* **download_heavy.txt**: A plain text file (generated by the Observed Antibody Space) containing the commands necessary to download all antibody heavy chain sequences used to create AntiRef.
* **download_light.txt**: A plain text file (generated by the Observed Antibody Space) containing the commands necessary to download all antibody light chain sequences used to create AntiRef.


